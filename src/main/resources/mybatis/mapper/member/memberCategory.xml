<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spark.dating.member.MemberCategoryDao">

  <resultMap id="PreferenceCategoryMap" type="PreferenceCategory">
    <id property="pc_no" column="PC_NO"/>
    <result property="pc_type" column="PC_TYPE"/>
    <result property="pc_typenum" column="PC_TYPENUM"/>
    <result property="pc_group" column="PC_GROUP"/>
    <result property="pc_name" column="PC_NAME"/>
  </resultMap>

  <resultMap id="PreferenceResponseMap" type="PreferenceResponse">
    <result property="member_No" column="MEMBER_NO"/>

    <collection property="selfPrefers" 
                ofType = "PreferenceCategory"
                resultMap ="PreferenceCategoryMap"/>

    <collection property="partnerPrefers"
                ofType="PreferenceCategory"
                resultMap="PreferenceCategoryMap"/>
  </resultMap>

  <insert id="insertMemberCategories" parameterType="map">
    insert all
    <foreach collection="preferNos" item="preferNo">
     into MemberCategory(
       MP_MEMBERNO, MP_PREFERNO, MP_CREATEDAT
     ) 
     values(
      #{mp_memberNo}, #{mp_preferNo}, SYSDATE
     )
    </foreach>
    select 1 from dual
  </insert>


  

</mapper>